{% extends "base.html" %}


{% block content %}
<style>
<<<<<<< HEAD
  #map-sandlot {
    border: 1px solid;
  }

  .infobar {
    background-color:#dceaf4;
    margin-bottom:2px;
    border:1px solid;
    min-height:100px;
  }
=======

.controls-wrapper {
    left: 1%;
    position: absolute;
    text-align: right;
    visibility: hidden;
}

.highcontrols-wrapper {
    z-index: 101;
    top: -4px;
}

.lowcontrols-wrapper {
    z-index: 100;
    top: 45px;
}

.note-wrapper:hover .controls-wrapper{
    visibility: visible;
    transition:background .4s ease-in;
}

.box-wrapper {
    opacity: .85;
    filter:alpha(opacity=85);
}

.box-wrapper:hover {
    background:lightgreen;
    opacity:1.0;
    filter:alpha(opacity=100);
    -o-transition:background .4s ease-in;
    -ms-transition:background .4s ease-in;
    -moz-transition:background .4s ease-in;
    -webkit-transition:background .4s ease-in;
    /* ...and now override with proper CSS property */
    transition:background .4s ease-in;
}

.zoom-box:hover {
    cursor: -webkit-zoom-in;
    cursor: -moz-zoom-in;
}

.box:hover {
	-webkit-box-shadow: 0 0 11px rgba(0, 0, 0, 0.2), inset 0 0 1px rgba(0, 0, 0, 0.1);
	-moz-box-shadow: 0 0 11px rgba(0, 0, 0, 0.2), inset 0 0 1px rgba(0, 0, 0, 0.1);
	box-shadow: 0 0 11px rgba(0, 0, 0, 0.2), inset 0 0 1px rgba(0, 0, 0, 0.1);
}

.margin-left {
    margin-left: 10px;
}

.margin-bottom {
    margin-bottom: 5px;
}

.modal {
    left: 27%;
    width: 93%;
}
>>>>>>> da94811... some front end work

  .weight {
    width:35px;
  }
</style>

<<<<<<< HEAD
{% block content %}
<hr>
<div class="container-fluid">
  {% if mapping %}
  <div class="row-fluid" id="show-canvas">
    <div class="row-fluid infobar">
      <div id="map-root"></div>
      <div id="map-note" style="display:hidden">
        <div class="span1">
          <div class="row-fluid" id="note-time"></div>
          <div class="row-fluid">
            <input class="weight" id="note-weight" type="number" max=10>
          </div>
        </div>
        <div class="span11" id="note-text"></div>
      </div>
      <div id="map-site" style="display:hidden">
        <div class="span1" id="site-weight">
          <input class="weight" id="site-weight" type="number" max=10>
        </div>
        <div class="span11" id="site-title"></div>
      </div>
    </div>
    <hr>
    <div class="row-fluid">
      <div class="container-fluid" id="map-sandlot"></div>
    </div>
  </div>
  {% endif %}
</div>
{% endblock %}
=======

<h2>{{ mapping.name }}</h2>
{% for note in mapping.notes %}
    <div class="row note-wrapper">
        <div class="span12">
            <div class="box-wrapper" >
                <div class="box shadow-box">
                      <div class="controls-wrapper highcontrols-wrapper">
                          <input class="loopId" type="hidden" value="{{ note.id }}"/>
                          <input class="mapId" type="hidden" value="{{ mapping.id }}"/>
                          <div class="row ">
                              <div class="span7">
                                  <div class="btn-toolbar pull-left">
                                      <div class="btn-group">
                                        <a class="btn removeNote" href="#"><i class="icon-remove"></i> Remove</a>
                                      </div>
                                  </div>
                                  <div class="btn-toolbar margin-left pull-left">
                                      <input type="text" class="input-small reindexNote" placeholder="Reindex to #">
                                  </div>
                              </div>
                              <div class="span5"></div>
                          </div>
                      </div>
                  <div class="row margin-bottom">
                      <div class="span11">
                          <span class="pull-right">
                              <em><small class="muted">{{ note.creation_time.strftime('%Y-%m-%d') }}</small></em>
                          </span>
                      </div>
                  </div>
                  <div class="row">
                      <div class="span8 offset2">
                        {% if loop.index % 2 == 0 %} <blockquote> {% else %} <blockquote class="pull-right"> {% endif %}
                          <p class="noteText zoom-box" data-toggle="modal" data-target="#myModal{{ loop.index }}">{{ note.text }}</p>
                          <small>
                              <cite title="{{ note.url }}">
                                  <a target="_blank" href="{{ note.url }}">{{ note.url[0:40] }}</a>
                              </cite>
                          </small>
                        </blockquote>
                      </div>
                  </div>
                  <div class="row">
                      <div class="span5">
                          <h6 class="muted pull-left">{{ loop.index }}</h6>
                      </div>
                  </div>
                </div>
            </div>
            <!-- Modal -->
            <div id="myModal{{ loop.index }}" class="modal hide fade" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
              <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal" aria-hidden="true">Ã—</button>
                <h3 id="myModalLabel">{{ mapping.name }}</h3>
              </div>
              <div class="modal-body">
                <div class="box">
                  <div class="row margin-bottom">
                      <div class="span11">
                          <span class="pull-right">
                              <em><small class="muted">{{ note.creation_time.strftime('%Y-%m-%d') }}</small></em>
                          </span>
                      </div>
                  </div>
                  <div class="row">
                      <div class="span8 offset2">
                        {% if loop.index % 2 == 0 %} <blockquote> {% else %} <blockquote class="pull-right"> {% endif %}
                          <p class="noteText">{{ note.text }}</p>
                          <small>
                              <cite title="{{ note.url }}">
                                  <a target="_blank" href="{{ note.url }}">{{ note.url[0:40] }}</a>
                              </cite>
                          </small>
                        </blockquote>
                      </div>
                  </div>
                  <div class="row">
                      <div class="span1">
                          <h6 class="muted pull-left">{{ loop.index }}</h6>
                      </div>
                  </div>
                </div>
              </div>
            </div>
        </div>
    </div>
{% endfor %}

    <script type="text/javascript">

    $(function() {
        $('a.removeNote').bind('click', function() {
          $.getJSON('{{ url_for('remove_index') }}', {
            loopId: $(this).closest('.controls-wrapper').children('.loopId').val(),
            mapId: $(this).closest('.controls-wrapper').children('.mapId').val()
          }, function(data) {
            window.console.log(data.result);
          });
          return false;
        });
    });

    $(function() {
        $('input.reindexNote').keyup(function(event){
            if(event.keyCode == 13){
              $.getJSON('{{ url_for('reindex_note') }}', {
                loopId: $(this).closest('.controls-wrapper').children('.loopId').val(),
                targetIndex: $(this).val(),
                mapId: $(this).closest('.controls-wrapper').children('.mapId').val()
              }, function(data) {
                window.console.log(data.result);
              });
            }
          return false;
        });
    });

    </script>
>>>>>>> da94811... some front end work

{% endblock %}
